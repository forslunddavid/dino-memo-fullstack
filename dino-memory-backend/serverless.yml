org: davidprivat
service: dino-memory-backend

provider:
    name: aws
    runtime: nodejs20.x
    region: eu-north-1
    profile: Dino-Memory-David
    iam:
        role: arn:aws:iam::310717438345:role/Dino-Memory-Role
    environment:
        GAMES_TABLE: Games
        DINOSAURS_TABLE: Dinosaurs

functions:
    createGame:
        handler: handler.createGame
        events:
            - http:
                  path: game
                  method: post
                  cors: true
    getGame:
        handler: handler.getGame
        events:
            - http:
                  path: game/{gameId}
                  method: get
                  cors: true
    updateGame:
        handler: handler.updateGame
        events:
            - http:
                  path: game/{gameId}
                  method: put
                  cors: true
    joinGame:
        handler: handler.joinGame
        events:
            - http:
                  path: game/{gameId}/join
                  method: put
                  cors: true
    getDinosaurs:
        handler: handler.getDinosaurs
        events:
            - http:
                  path: dinosaurs
                  method: get
                  cors: true

resources:
    Resources:
        GamesTable:
            Type: AWS::DynamoDB::Table
            Properties:
                TableName: ${self:provider.environment.GAMES_TABLE}
                AttributeDefinitions:
                    - AttributeName: gameId
                      AttributeType: S
                KeySchema:
                    - AttributeName: gameId
                      KeyType: HASH
                BillingMode: PAY_PER_REQUEST
        DinosaursTable:
            Type: AWS::DynamoDB::Table
            Properties:
                TableName: ${self:provider.environment.DINOSAURS_TABLE}
                AttributeDefinitions:
                    - AttributeName: species
                      AttributeType: S
                KeySchema:
                    - AttributeName: species
                      KeyType: HASH
                BillingMode: PAY_PER_REQUEST

custom:
    esbuild:
        build: false
